language: node_js
node_js:
- 0.10.33
script: npm test
after_success:
- if [ $TRAVIS_BRANCH != "master" ]; exit 1; fi
- git config --global user.email "${GIT_EMAIL}"
- git config --global user.name "${GIT_NAME}"
- git clone --quiet --branch=stable https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}
  travis-build > /dev/null
- cd travis-build
- git fetch --quiet > /dev/null
- git merge origin/master --no-commit > /dev/null
- git commit -m "Travis CI auto-merge from travis build ${TRAVIS_BUILD_NUMBER}"
- npm version patch -m "Travis CI auto-version from travis build ${TRAVIS_BUILD_NUMBER}"
- git push -fq origin stable > /dev/null
before_deploy:
- npm install
deploy:
  skip_cleanup: true
  provider: npm
  email: todd@deepelement.com
  api_key:
    secure: LNH3+jZBYyvPRlQvlERJ+KiQ/4FofRm17aWLphcCkRn/7jcokcJBgRXG/v1d0HlSejnqGFfgjzti5HkAe0auj+TVZtDkqMiVM0V4O4ZE3DlKOPNAU0pTNjyfesa8ccryASMgmkxxoq74qNXCiS+VSRVArg5XqCvC0/9mDXgxgmfBCUec9MlUqgJqsYxv++i80eTYrXPm57mlj6yo38CAti4wFlPmeRZ0dxA/X4/HYytMC2nQQ+JzXkTLdsMufYYXY9neWOhWNA2kSv0KrWbnnyMLQFEvbgNu/nxxgt3WA3LqO87PcCoQnCwqBVgh+pa4t4rC1lfe3JJwLN2mAvLUg1IRBk2zXic2YgDy7uvncTNJnpHRhC1HcPOV5Xi6ZhEQv6+X6D1EJ9xNLDTwayRonCFK0JriT0H3RTkDirbzRrshxlLLfSNMW41qpU4bSgi8nkMoiMiKsjBL5I8fIDrDmwIqlBqRObjdrw4pz4WeOFsmvcfQrt7AqFVovRxzFIWlBmfPJo6aAK7nbkSK80zgzbRqriMwyGthzk91cryv3w0W8Ly3i7fJCtusKuJK2VqDUVxTtU5QjbFcIJGyA35uHgQCueLoWC4hCyYdz0Z0w9mh9oikXaJ3S580cgW1vYMZKgHohzcXCnCq1XgHInKvlTDjGDss8HMhW+0RqAGC5R8=
  on:
    repo: DeepElement/winjs-rocks
    branch: stable
